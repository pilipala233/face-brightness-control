# Face Brightness Control

åŸºäº Electron çš„æ™ºèƒ½äººè„¸æ£€æµ‹è‡ªåŠ¨äº®åº¦æ§åˆ¶åº”ç”¨ï¼Œå†ä¹Ÿä¸ç”¨å®³æ€•ç¬”è®°æœ¬æ¶é«˜åè¢«èº«åçš„åŒäº‹çª¥å±äº†ï¼ŒåŒæ—¶ä¹Ÿé—´æ¥è§£å†³äº†è€æ¿ä»èƒŒåå‡ºç°å´æ²¡äººæé†’ä½ çš„çƒ¦æ¼

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¥ **å®æ—¶äººè„¸æ£€æµ‹**ï¼šä½¿ç”¨ face-api.js è¿›è¡Œå®æ—¶æ‘„åƒå¤´äººè„¸æ£€æµ‹
- ğŸ’¡ **æ™ºèƒ½äº®åº¦æ§åˆ¶**ï¼šæ£€æµ‹åˆ°æŒ‡å®šæ•°é‡äººè„¸æ—¶è‡ªåŠ¨é™ä½å±å¹•äº®åº¦
- ğŸ¯ **äººè„¸æ•°é‡é˜ˆå€¼**ï¼šå¯è‡ªå®šä¹‰è§¦å‘äº®åº¦è°ƒèŠ‚çš„äººè„¸æ•°é‡ï¼ˆé»˜è®¤â‰¥2äººï¼‰
- ğŸ”§ **å¤šæ¨¡å‹æ”¯æŒ**ï¼šæ”¯æŒ TinyFaceDetectorï¼ˆå¿«é€Ÿï¼‰å’Œ SSD MobileNetï¼ˆå‡†ç¡®ï¼‰
- âš™ï¸ **çµæ´»é…ç½®**ï¼šå¯è°ƒèŠ‚æ£€æµ‹é—´éš”ã€çµæ•åº¦ã€äº®åº¦èŒƒå›´ç­‰å‚æ•°
- ğŸ–¼ï¸ **å¯è§†åŒ–æ£€æµ‹**ï¼šå®æ—¶æ˜¾ç¤ºæ£€æµ‹åˆ°çš„äººè„¸æ¡†å’Œç½®ä¿¡åº¦
- ğŸ–¥ï¸ **è·¨å¹³å°æ”¯æŒ**ï¼šæ”¯æŒ Windows å’Œ macOS
- ğŸ“¦ **ç»¿è‰²ä¾¿æº**ï¼šæ— éœ€å®‰è£…é¢å¤–ä¾èµ–ï¼Œå¼€ç®±å³ç”¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

**æ³¨æ„ï¼š** é¡¹ç›®å·²é…ç½®æ·˜å®é•œåƒæºï¼ˆ`.npmrc`ï¼‰ï¼Œå›½å†…ç”¨æˆ·å®‰è£…é€Ÿåº¦æ›´å¿«ã€‚

### è¿è¡Œå¼€å‘ç‰ˆ

```bash
npm start   # æˆ– npm run dev
```

**è·¨å¹³å°è‡ªåŠ¨é€‚é…**ï¼š
- Windows: è‡ªåŠ¨è®¾ç½® UTF-8 ç¼–ç ï¼Œé¿å…ä¸­æ–‡ä¹±ç 
- macOS/Linux: ç›´æ¥å¯åŠ¨

### æ‰“åŒ…åº”ç”¨

```bash
# è·¨å¹³å°æ‰“åŒ…ï¼ˆæ¨èï¼‰
npm run build       # è‡ªåŠ¨æ ¹æ®å½“å‰å¹³å°æ‰“åŒ…

# æŒ‡å®šå¹³å°æ‰“åŒ…
npm run build:win   # æ‰“åŒ… Windows ç‰ˆæœ¬ï¼ˆx64 ä¾¿æºç‰ˆ exeï¼‰
npm run build:mac   # æ‰“åŒ… macOS ç‰ˆæœ¬ï¼ˆ.appï¼‰

# å…¶ä»–
npm run build:dir   # æ‰“åŒ…ä¸ºç›®å½•ï¼ˆæµ‹è¯•ç”¨ï¼Œä¸å‹ç¼©ï¼‰
```

æ‰“åŒ…åçš„æ–‡ä»¶ä½äº `dist/` ç›®å½•ï¼š
- Windows: `äººè„¸äº®åº¦æ§åˆ¶-1.0.0-portable.exe`
- macOS: `äººè„¸äº®åº¦æ§åˆ¶.app`

## ğŸ–¥ï¸ å¹³å°æ”¯æŒ

| å¹³å° | çŠ¶æ€ | äº®åº¦æ§åˆ¶æ–¹æ¡ˆ | è¯´æ˜ |
|------|------|--------------|------|
| **Windows 10/11** | âœ… å®Œå…¨æ”¯æŒ | PowerShell + WMI | ç¬”è®°æœ¬å†…ç½®å±å¹• |
| **macOS** | âœ… å®Œå…¨æ”¯æŒ | DisplayServices æ¡†æ¶ | MacBook å†…ç½®å±å¹• |
| **Linux** | âšª æš‚ä¸æ”¯æŒ | - | è®¡åˆ’ä¸­ |

## ğŸ’» æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Electron 39.x
- **äººè„¸æ£€æµ‹**: @vladmandic/face-api 1.7.x
- **äº®åº¦æ§åˆ¶**: 
  - Windows: PowerShell + WMI
  - macOS: DisplayServices ç§æœ‰æ¡†æ¶ï¼ˆåŸç”Ÿï¼‰
- **è·¨å¹³å°è„šæœ¬**: run-script-os
- **æ‰“åŒ…å·¥å…·**: electron-builder

## ğŸ“– ä½¿ç”¨è¯´æ˜

### åŸºæœ¬æµç¨‹

1. å¯åŠ¨åº”ç”¨åï¼Œå…è®¸æ‘„åƒå¤´æƒé™
2. åº”ç”¨è‡ªåŠ¨åŠ è½½äººè„¸æ£€æµ‹æ¨¡å‹
3. ç‚¹å‡»"å¯åŠ¨æ£€æµ‹"å¼€å§‹å®æ—¶æ£€æµ‹
4. å½“æ£€æµ‹åˆ°çš„äººè„¸æ•°é‡è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨é™ä½äº®åº¦
5. äººè„¸æ¶ˆå¤±åï¼Œè‡ªåŠ¨æ¢å¤åŸå§‹äº®åº¦

### å‚æ•°è®¾ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| æ£€æµ‹æ¨¡å‹ | SSD MobileNet | æ›´å‡†ç¡®ä½†ç¨æ…¢ï¼Œå¯é€‰ TinyFaceDetectorï¼ˆå¿«é€Ÿï¼‰ |
| æ£€æµ‹é—´éš” | 500ms | æ£€æµ‹é¢‘ç‡ï¼Œå€¼è¶Šå°è¶Šé¢‘ç¹ï¼ˆæ›´è€—ç”µï¼‰ |
| æ£€æµ‹çµæ•åº¦ | 0.5ï¼ˆä½ï¼‰ | è¿‘è·ç¦»æ£€æµ‹ï¼Œå¯è°ƒæ•´ä¸ºé«˜/ä¸­/ä½ |
| æœ€ä½äº®åº¦ | 10% | æ£€æµ‹åˆ°äººè„¸æ—¶çš„ç›®æ ‡äº®åº¦ |
| æœ€é«˜äº®åº¦ | è‡ªåŠ¨æ£€æµ‹ | æ— äººè„¸æ—¶çš„äº®åº¦ï¼ˆå¯åŠ¨æ—¶è‡ªåŠ¨è·å–å½“å‰äº®åº¦ï¼‰ |
| äººè„¸æ•°é‡é˜ˆå€¼ | 2 | è§¦å‘äº®åº¦é™ä½æ‰€éœ€çš„æœ€å°äººè„¸æ•°é‡ |

### å…¸å‹ä½¿ç”¨åœºæ™¯

**åœºæ™¯ï¼šé˜²æ­¢ä»–äººå·çœ‹å±å¹•**
- è®¾ç½®äººè„¸é˜ˆå€¼ä¸º 2
- å½“åªæœ‰ä½ è‡ªå·±æ—¶ï¼ˆ1å¼ äººè„¸ï¼‰ï¼šä¿æŒæ­£å¸¸äº®åº¦
- å½“æœ‰äººé è¿‘ï¼ˆâ‰¥2å¼ äººè„¸ï¼‰ï¼šè‡ªåŠ¨é™ä½äº®åº¦ä¿æŠ¤éšç§

## ğŸ”§ æŠ€æœ¯äº®ç‚¹

### äº®åº¦æ§åˆ¶å®ç°

#### Windows
æœ¬é¡¹ç›®**ä¸ä½¿ç”¨**å·²å¼ƒç”¨çš„ `wmic` å‘½ä»¤ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨ **PowerShell + WMI** APIï¼š

```powershell
# è·å–äº®åº¦
powershell -Command "(Get-WmiObject -Namespace root/WMI -Class WmiMonitorBrightness).CurrentBrightness"

# è®¾ç½®äº®åº¦
powershell -Command "(Get-WmiObject -Namespace root/WMI -Class WmiMonitorBrightnessMethods).WmiSetBrightness(1, 50)"
```

ä¼˜åŠ¿ï¼š
- âœ… æ— éœ€ç¬¬ä¸‰æ–¹ä¾èµ–
- âœ… æ‰“åŒ…åæ­£å¸¸å·¥ä½œ
- âœ… ä¸ä¾èµ–å·²å¼ƒç”¨çš„ wmic
- âœ… å…¼å®¹ Windows 10/11

#### macOS
ä½¿ç”¨ **DisplayServices ç§æœ‰æ¡†æ¶**ï¼Œé€šè¿‡ç¼–è¯‘çš„ Objective-C äºŒè¿›åˆ¶ç¨‹åºæ§åˆ¶äº®åº¦ï¼š

```objectivec
// åŠ¨æ€åŠ è½½ DisplayServices æ¡†æ¶
void* handle = dlopen("/System/Library/PrivateFrameworks/DisplayServices.framework/DisplayServices", RTLD_LAZY);

// è°ƒç”¨äº®åº¦æ§åˆ¶å‡½æ•°
DisplayServicesSetBrightness(display, brightness);
DisplayServicesGetBrightness(display, &brightness);
```

ä¼˜åŠ¿ï¼š
- âœ… æ— éœ€ç”¨æˆ·å®‰è£…ä»»ä½•ä¾èµ–
- âœ… ç›´æ¥æ§åˆ¶ MacBook å†…ç½®å±å¹•
- âœ… æ‰“åŒ…åæ­£å¸¸å·¥ä½œ
- âœ… ä¸éœ€è¦è¾…åŠ©åŠŸèƒ½æƒé™

### äººè„¸æ£€æµ‹æ¨¡å‹

- **TinyFaceDetector**: è½»é‡å¿«é€Ÿï¼Œé€‚åˆä½é…ç½®è®¾å¤‡
- **SSD MobileNet**: å‡†ç¡®åº¦é«˜ï¼Œæ¨èä½¿ç”¨ï¼ˆé»˜è®¤ï¼‰
- æ¨¡å‹æ–‡ä»¶å·²åŒ…å«åœ¨ `@vladmandic/face-api` npm åŒ…ä¸­

## âš ï¸ æ³¨æ„äº‹é¡¹

### ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: 
  - Windows 10/11
  - macOS 10.13 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ‘„åƒå¤´**: éœ€è¦å¯ç”¨çš„æ‘„åƒå¤´è®¾å¤‡
- **æƒé™**: é¦–æ¬¡è¿è¡Œéœ€è¦æˆäºˆæ‘„åƒå¤´æƒé™

### äº®åº¦æ§åˆ¶é™åˆ¶

#### Windows
- âœ… **ç¬”è®°æœ¬å†…ç½®å±å¹•**: å®Œå…¨æ”¯æŒ
- âŒ **å¤–æ¥æ˜¾ç¤ºå™¨**: å¤§å¤šæ•°ä¸æ”¯æŒè½¯ä»¶æ§åˆ¶ï¼ˆç¡¬ä»¶é™åˆ¶ï¼‰
- âš ï¸ **æŸäº›æ˜¾ç¤ºå™¨**: éœ€è¦æ”¯æŒ DDC/CI åè®®

#### macOS
- âœ… **MacBook å†…ç½®å±å¹•**: å®Œå…¨æ”¯æŒ
- âŒ **å¤–æ¥æ˜¾ç¤ºå™¨**: ä¸æ”¯æŒï¼ˆæŠ€æœ¯é™åˆ¶ï¼‰
- âœ… **æ— éœ€é¢å¤–æƒé™**: ä½¿ç”¨ç³»ç»Ÿæ¡†æ¶ï¼Œä¸éœ€è¦è¾…åŠ©åŠŸèƒ½æƒé™
- âš ï¸ **é¦–æ¬¡è¿è¡Œ**: å¯èƒ½æç¤º"æ¥è‡ªæœªè¯†åˆ«çš„å¼€å‘è€…"
  - è§£å†³æ–¹æ³•ï¼šç³»ç»Ÿè®¾ç½® -> éšç§ä¸å®‰å…¨æ€§ -> ä»è¦æ‰“å¼€

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

- ä½¿ç”¨ TinyFaceDetector æ¨¡å‹å¯æå‡æ€§èƒ½
- å¢åŠ æ£€æµ‹é—´éš”ï¼ˆå¦‚ 1000msï¼‰å¯é™ä½ CPU å ç”¨
- å…³é—­"æ˜¾ç¤ºäººè„¸æ£€æµ‹æ¡†"å¯æå‡æ€§èƒ½

## ğŸ“ é¡¹ç›®ç»“æ„

```
face-brightness-control/
â”œâ”€â”€ main.js                  # Electron ä¸»è¿›ç¨‹
â”œâ”€â”€ renderer.js              # æ¸²æŸ“è¿›ç¨‹ï¼ˆäººè„¸æ£€æµ‹é€»è¾‘ï¼‰
â”œâ”€â”€ index.html               # ä¸»ç•Œé¢
â”œâ”€â”€ styles.css               # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ brightness-final         # macOS äº®åº¦æ§åˆ¶äºŒè¿›åˆ¶
â”œâ”€â”€ brightness-final.m       # macOS äº®åº¦æ§åˆ¶æºç 
â”œâ”€â”€ package.json             # é¡¹ç›®é…ç½®
â”œâ”€â”€ .npmrc                   # npm é•œåƒé…ç½®ï¼ˆæ·˜å®æºï¼‰
â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜
â””â”€â”€ USAGE.md                 # è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
```

## ğŸ› ï¸ å¼€å‘

### å¼€å‘æ¨¡å¼

```bash
npm start        # å¯åŠ¨åº”ç”¨ï¼ˆè‡ªåŠ¨æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼‰
npm run dev      # åŒä¸Š
```

### æ‰“åŒ…é…ç½®

æ‰“åŒ…é…ç½®ä½äº `package.json` çš„ `build` å­—æ®µï¼š

- è¾“å‡ºç›®å½•: `dist/`
- æ‰“åŒ…å‘½ä»¤:
  - `npm run build` - è‡ªåŠ¨æ ¹æ®å½“å‰å¹³å°æ‰“åŒ…
  - `npm run build:win` - æ‰“åŒ… Windows x64 ä¾¿æºç‰ˆ
  - `npm run build:mac` - æ‰“åŒ… macOS é€šç”¨ç‰ˆï¼ˆæ”¯æŒ Intel å’Œ Apple Siliconï¼‰
- æ‰“åŒ…æ ¼å¼: 
  - Windows: ä¾¿æºç‰ˆ exeï¼ˆç»¿è‰²å…å®‰è£…ï¼‰
  - macOS: .app åº”ç”¨åŒ…

### é‡æ–°ç¼–è¯‘ macOS äº®åº¦æ§åˆ¶ç¨‹åº

å¦‚æœéœ€è¦ä¿®æ”¹ macOS äº®åº¦æ§åˆ¶é€»è¾‘ï¼Œå¯ä»¥é‡æ–°ç¼–è¯‘ï¼š

```bash
cd /path/to/project
clang -o brightness-final brightness-final.m -framework Foundation -framework CoreGraphics
```

### è°ƒè¯•æŠ€å·§

å¼€å‘æ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨æ‰“å¼€ F12 å¼€å‘è€…å·¥å…·ï¼Œå¯ä»¥ï¼š
- æŸ¥çœ‹äººè„¸æ£€æµ‹çš„è°ƒè¯•ä¿¡æ¯
- ç›‘æ§æ€§èƒ½å’Œå†…å­˜å ç”¨
- è°ƒè¯• IPC é€šä¿¡

## ğŸ“„ è®¸å¯è¯

ISC

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“® è”ç³»æ–¹å¼

- GitHub: [@pilipala233](https://github.com/pilipala233)
- é¡¹ç›®åœ°å€: https://github.com/pilipala233/face-brightness-control

## ğŸ™ è‡´è°¢

- [Electron](https://www.electronjs.org/) - è·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶
- [@vladmandic/face-api](https://github.com/vladmandic/face-api) - äººè„¸æ£€æµ‹åº“
- [electron-builder](https://www.electron.build/) - Electron æ‰“åŒ…å·¥å…·

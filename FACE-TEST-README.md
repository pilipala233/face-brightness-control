# 🎭 人脸识别测试工具使用说明

这是一个测试 face-api.js 人脸特征提取和识别能力的工具。

## 🚀 启动方式

### 方法1：通过菜单（推荐）
1. 启动应用：`npm start`
2. 点击菜单栏：**工具 → 人脸识别测试**

### 方法2：直接打开（开发）
修改 `main.js` 的 `createWindow()` 函数，将：
```javascript
mainWindow.loadFile('index.html');
```
临时改为：
```javascript
mainWindow.loadFile('face-test.html');
```

## 📖 使用流程

### 第一步：拍摄照片（可选）

1. **启动摄像头**
   - 点击"启动摄像头"按钮
   - 允许浏览器访问摄像头权限

2. **选择保存文件夹**
   - 点击"选择保存文件夹"
   - 选择一个文件夹用于存放照片

3. **拍照**
   - 对准摄像头
   - 点击"拍照"按钮
   - 照片会自动保存到选定的文件夹

💡 **建议**：拍摄多个角度的照片（正脸、侧脸、戴眼镜等）

---

### 第二步：分析人脸特征

1. **选择图片文件夹**
   - 点击右侧的"选择文件夹"
   - 选择包含人脸照片的文件夹

2. **配置标注（可选）**
   - ✅ 勾选"标记为本人"：如果这些照片是你自己
   - 💬 填写"备注信息"：例如"正脸"、"侧脸"、"戴眼镜"

3. **开始分析**
   - 点击"开始分析"按钮
   - 等待分析完成

4. **查看结果**
   - 成功：人脸特征被提取并保存
   - 失败：该图片未检测到人脸

---

### 第三步：实时识别测试

分析完成后，左侧的"实时检测结果"区域会显示：

- ✅ **匹配到本人**：显示绿色，标注为你保存的名称
- ⚠️ **未知人脸**：显示橙色，表示不在已知列表中
- 相似度百分比：显示匹配的置信度

---

## 🎯 测试场景

### 场景1：测试单人识别
1. 拍摄 5-10 张自己的照片
2. 分析时勾选"标记为本人"
3. 对着摄像头，查看是否能识别到"本人"
4. 换个角度、表情，测试识别稳定性

### 场景2：测试多人区分
1. 准备自己的照片（标记为本人）
2. 准备朋友/家人的照片（不标记为本人）
3. 分别分析两组照片
4. 测试能否正确区分不同的人

### 场景3：测试识别阈值
1. 分析完照片后
2. 让不同的人对着摄像头
3. 观察相似度百分比
4. **阈值说明**：
   - < 60%：视为匹配
   - 60-80%：相似但不确定
   - > 80%：完全不同

---

## 📊 理解识别原理

### face-api.js 工作流程

1. **人脸检测**：找到图片中的人脸位置
2. **特征提取**：提取 128 维的人脸描述符（Descriptor）
3. **相似度计算**：计算欧氏距离（Euclidean Distance）
   - 距离越小 = 越相似
   - 距离 < 0.6 = 同一个人

### 关键模型

- `ssdMobilenetv1`：人脸检测
- `faceLandmark68Net`：68 个面部特征点
- `faceRecognitionNet`：提取 128 维特征向量（基于 FaceNet）

---

## 💡 优化建议

### 提高识别准确率

1. **多样化照片**
   - 不同角度（正脸、左右侧脸）
   - 不同表情（微笑、严肃）
   - 不同光照条件
   - 不同装扮（戴/不戴眼镜）

2. **清晰的照片**
   - 避免模糊
   - 光线充足
   - 人脸清晰可见

3. **调整阈值**
   - 当前阈值：0.6
   - 降低阈值（0.5）：更严格，减少误判
   - 提高阈值（0.7）：更宽松，增加识别率

---

## 🔧 技术细节

### 数据存储

- 存储位置：`localStorage`
- 存储键：`savedFaces`
- 数据结构：
```json
{
  "id": "时间戳",
  "name": "文件名",
  "descriptor": [128维数组],
  "isOwner": true/false,
  "remark": "备注",
  "filePath": "文件路径",
  "timestamp": "ISO时间"
}
```

### 清空数据

点击"清空数据"按钮可以删除所有已保存的人脸特征。

---

## ⚠️ 注意事项

1. **隐私保护**
   - 人脸特征数据存储在本地
   - 不会上传到任何服务器
   - 可以随时清空数据

2. **性能影响**
   - 实时检测每 500ms 运行一次
   - 保存大量人脸数据会影响对比速度
   - 建议保存 < 50 张照片

3. **识别限制**
   - 需要清晰可见的人脸
   - 角度过大可能影响识别
   - 光照条件影响准确率

---

## 🎯 下一步应用

通过这个测试工具，你可以验证：
- face-api.js 的识别能力 ✅
- 特征提取的准确性 ✅
- 实时对比的性能 ✅

**准备好集成到主应用了吗？**

可以实现：
- 只有检测到"本人"才保持正常亮度
- 检测到"其他人"才降低亮度
- 更智能的隐私保护模式

---

**Happy Testing! 🎉**

